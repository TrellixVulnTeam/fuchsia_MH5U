# Copyright 2018 The Fuchsia Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# TODO(fxbug.dev/69585): Delete this config after all user code
# migrates to typed channels.
config("fidl-llcpp-deprecated-raw-channels") {
  cflags_cc = [ "-DFIDL_LLCPP_ALLOW_DEPRECATED_RAW_CHANNELS" ]

  # Please do not add to this list. Refer to fxbug.dev/69585 to see
  # how a target could be migrated to use typed channels.
  #
  # To regenerate this list, run
  #
  #   scripts/gn/trim_visibility.py --target="//build/cpp:fidl-llcpp-deprecated-raw-channels"
  #
  # and replace the contents of `visibility` with the script output.
  visibility = [
    "//examples/drivers/dotmatrix_display:bin2",
    "//garnet/public/lib/svc/cpp:cpp",
    "//garnet/public/lib/test_runner/cpp:cpp",
    "//src/bringup/bin/bootsvc:bootfs_loader_service_test",
    "//src/bringup/bin/bootsvc:lib",
    "//src/bringup/bin/bootsvc:util",
    "//src/bringup/bin/bootsvc/integration_test:bootsvc-integration-test",
    "//src/bringup/bin/console-launcher:bin",
    "//src/bringup/bin/console-launcher:lib",
    "//src/bringup/bin/pwrbtn-monitor:pwrbtn-monitor",
    "//src/bringup/bin/svchost:crashsvc",
    "//src/bringup/bin/svchost:crashsvc-test",
    "//src/bringup/bin/svchost:svchost",
    "//src/bringup/bin/sysinfo:sysinfo",
    "//src/bringup/bin/sysinfo:test",
    "//src/bringup/bin/waitfor:waitfor",
    "//src/cobalt/bin/system-metrics:system_metrics_daemon_lib",
    "//src/connectivity/telephony/drivers/qmi-fake-transport:fake_qmi_driver-driver",
    "//src/connectivity/telephony/tests/driver-integration:telephony-qmi-usb-integration-test",
    "//src/connectivity/telephony/tests/fake-drivers/at-fake-transport:fake_at_driver-driver",
    "//src/developer/memory/metrics:metrics",
    "//src/devices/bin/acpidump:src",
    "//src/devices/bin/driver-registrar:driver-registrar",
    "//src/devices/bin/driver_host:common",
    "//src/devices/bin/driver_host:driver_host_test",
    "//src/devices/bin/driverctl:driverctl",
    "//src/devices/bin/lsdev:lsdev",
    "//src/devices/bin/register-util:bin",
    "//src/devices/bin/register-util:register-util",
    "//src/devices/bin/unbind:unbind",
    "//src/devices/block/bin/sdio:sdio",
    "//src/devices/block/bin/sdio:sdio-test-bin",
    "//src/devices/block/drivers/block-verity:block-verity-test",
    "//src/devices/block/drivers/block-verity:verified-volume-client",
    "//src/devices/block/drivers/ftl/tests:ftl-integration",
    "//src/devices/block/drivers/sdmmc:sdmmc-driver",
    "//src/devices/block/drivers/sdmmc:sdmmc-test-bin",
    "//src/devices/block/drivers/usb-mass-storage:ums-integration",
    "//src/devices/board/drivers/x86/test:x86-board",
    "//src/devices/bus/drivers/platform:platform-bus-driver",
    "//src/devices/bus/drivers/platform:platform-bus-unittest",
    "//src/devices/bus/drivers/platform/test:platform-bus",
    "//src/devices/bus/drivers/platform/test:platform-bus-bti",
    "//src/devices/cpu/bin/cpuctl:cpuctl",
    "//src/devices/cpu/bin/cpuctl:cpuctl-test-bin",
    "//src/devices/cpu/drivers/aml-cpu:aml-cpu-test-bin",
    "//src/devices/cpu/drivers/aml-cpu-legacy:aml-cpu-legacy-driver",
    "//src/devices/cpu/drivers/aml-cpu-legacy:aml-cpu-legacy-test-bin",
    "//src/devices/gpio/bin/gpioutil:gpioutil",
    "//src/devices/gpio/bin/gpioutil:gpioutil-test-bin",
    "//src/devices/gpio/drivers/gpio:gpio-test-bin",
    "//src/devices/i2c/bin:i2cutil",
    "//src/devices/i2c/drivers/i2c:i2c-test-bin",
    "//src/devices/ml/drivers/aml-nna:aml-nna-driver",
    "//src/devices/ml/drivers/aml-nna:aml-nna-test-bin",
    "//src/devices/nand/bin/nand-util:common",
    "//src/devices/nand/drivers/broker/test:common",
    "//src/devices/power/drivers/ti-ina231:ti-ina231-test-bin",
    "//src/devices/ram/bin/ram-info:ram-info",
    "//src/devices/ram/bin/ram-info:ram-info-test-bin",
    "//src/devices/ram/drivers/aml-ram:aml-ram-test-bin",
    "//src/devices/registers/drivers/registers:registers-driver",
    "//src/devices/registers/drivers/registers:registers-test",
    "//src/devices/registers/testing/mock-registers:mock-registers-test",
    "//src/devices/securemem/drivers/aml-securemem:aml-securemem-driver",
    "//src/devices/securemem/drivers/aml-securemem:aml-securemem-test-bin",
    "//src/devices/serial/bin/serial-test:serial-test",
    "//src/devices/serial/drivers/virtio-console:virtio_console-driver",
    "//src/devices/spi/drivers/spi:spi-driver",
    "//src/devices/spi/drivers/spi:spi-test-bin",
    "//src/devices/sysmem/drivers/sysmem:sysmem-unittest-bin",
    "//src/devices/sysmem/drivers/sysmem:sysmem_common_srcs",
    "//src/devices/sysmem/tools:common_srcs",
    "//src/devices/temperature/drivers/tmp112:tmp112-test-bin",
    "//src/devices/testing/fake_ddk:fake_ddk",
    "//src/devices/tests/bind-fail-test:tests",
    "//src/devices/tests/ddk-environment-test:ddk-environment",
    "//src/devices/tests/ddk-metadata-test:tests",
    "//src/devices/tests/ddk-power:ddk-power",
    "//src/devices/tests/ddk-runcompatibilityhook:ddk-runcompatibilityhook",
    "//src/devices/tests/devfs:devfs",
    "//src/devices/tests/driver-inspect-test:tests",
    "//src/devices/tests/mock-device:mock-device-driver",
    "//src/devices/usb/bin/usb-fwloader:usb-fwloader",
    "//src/devices/usb/bin/usbctl:usbctl",
    "//src/devices/usb/drivers/aml-usb-phy-v2:aml-usb-phy-test-bin",
    "//src/devices/usb/drivers/aml-usb-phy-v2:aml-usb-phy-v2-driver",
    "//src/devices/usb/drivers/usb-bus:usb-device",
    "//src/devices/usb/drivers/usb-peripheral:usb-peripheral-driver",
    "//src/devices/usb/drivers/usb-peripheral:usb-peripheral-unittest-bin",
    "//src/devices/usb/drivers/usb-virtual-bus:usb-virtual-bus-test-bin",
    "//src/graphics/display/bin/display-test:display-test",
    "//src/graphics/display/bin/dsiutil:dsiutil",
    "//src/graphics/display/drivers/amlogic-display:amlogic-display-test",
    "//src/graphics/display/drivers/amlogic-display:common_srcs",
    "//src/graphics/display/drivers/display:shared",
    "//src/graphics/display/drivers/display/tests:base",
    "//src/graphics/display/drivers/display/tests:display-core-unittests",
    "//src/graphics/display/drivers/fake:fake-display-device-tree",
    "//src/graphics/display/drivers/intel-i915:intel-i915-test",
    "//src/graphics/display/testing:testing",
    "//src/graphics/drivers/aml-gpu:aml-gpu-test-bin",
    "//src/graphics/drivers/aml-gpu:sources",
    "//src/graphics/drivers/msd-arm-mali/tests/integration:msd_arm_mali_integration_tests",
    "//src/graphics/drivers/msd-intel-gen/tests/integration:msd_intel_gen_integration_tests",
    "//src/graphics/drivers/msd-vsi-vip/tests/integration:msd_vsi_vip_integration_tests",
    "//src/graphics/drivers/virtio:gpu_lib",
    "//src/graphics/drivers/virtio:virtio-gpu-test",
    "//src/graphics/lib/magma/src/magma_util/platform/zircon:connection",
    "//src/graphics/lib/magma/src/magma_util/platform/zircon:connection_client",
    "//src/graphics/lib/magma/src/magma_util/platform/zircon:device_client",
    "//src/graphics/lib/magma/src/magma_util/platform/zircon:logger",
    "//src/graphics/lib/magma/src/magma_util/platform/zircon:sysmem_connection",
    "//src/graphics/lib/magma/src/tools:magma-info-bin",
    "//src/graphics/lib/magma/tests/helper:test_device_helper",
    "//src/graphics/lib/magma/tests/integration:magma_conformance_tests",
    "//src/graphics/lib/magma/tests/integration:virtmagma_conformance_tests",
    "//src/graphics/tests/goldfish_benchmark:goldfish_benchmark_bin",
    "//src/graphics/tests/goldfish_test:bin",
    "//src/graphics/tests/goldfish_test:goldfish_test_bin",
    "//src/graphics/tests/vkloop:vkloop",
    "//src/graphics/tests/vkloop:vkloop_bin",
    "//src/lib/fake-clock/lib:lib",
    "//src/lib/fidl/c/llcpp_interop_tests:bin",
    "//src/lib/fidl/c/walker_tests:test_sources",
    "//src/lib/isolated_devmgr:usb-virtual-bus",
    "//src/lib/loader_service:loader_service",
    "//src/lib/loader_service:loader_service_test",
    "//src/lib/loader_service:loader_service_test_fixture",
    "//src/lib/storage/block_client/cpp",
    "//src/lib/storage/fs_management/cpp:fs-management",
    "//src/lib/storage/fs_management/cpp:fs-management-test",
    "//src/media/audio/drivers/lib/intel-hda:intel-hda",
    "//src/media/audio/drivers/usb-audio:shared",
    "//src/media/audio/drivers/usb-audio:usb-audio-driver",
    "//src/media/audio/drivers/usb-audio/tests:usb-audio-test-bin",
    "//src/media/audio/tools/audio-driver-ctl:bin",
    "//src/media/drivers/amlogic_decoder/tests/runner:amlogic_decoder_integration_tests_bin",
    "//src/modular/lib/fidl:environment",
    "//src/power/shutdown-shim:shutdown-shim",
    "//src/recovery/factory_reset:factory_reset_unittests",
    "//src/security/zxcrypt:zxcrypt-client",
    "//src/security/zxcrypt:zxcrypt-fdio",
    "//src/security/zxcrypt/tests:zxcrypt",
    "//src/storage/bin/storage-metrics:storage-metrics",
    "//src/storage/factory/factoryfs:factoryfs",
    "//src/storage/fs_test:access_tests",
    "//src/storage/fs_test:corrupt_tests",
    "//src/storage/fs_test:dot_dot_tests",
    "//src/storage/fs_test:fs_test",
    "//src/storage/fs_test:rename_tests",
    "//src/storage/fs_test:resize_tests",
    "//src/storage/fs_test:watcher_tests",
    "//src/storage/fshost:block-watcher",
    "//src/storage/fshost:fshost",
    "//src/storage/fshost:fshost-registry",
    "//src/storage/fshost:fshost_integration_test",
    "//src/storage/fshost:fshost_test",
    "//src/storage/fvm:fvm-integration",
    "//src/storage/fvm:test_support",
    "//src/storage/fvm/driver/test:fvm-driver-integration",
    "//src/storage/lib/paver:gpt",
    "//src/storage/lib/paver:nelson",
    "//src/storage/lib/paver:paver",
    "//src/storage/lib/paver:paver-core",
    "//src/storage/lib/paver:skip-block",
    "//src/storage/lib/paver/test:test",
    "//src/storage/memfs:memfs",
    "//src/storage/minfs:minfs",
    "//src/storage/minfs/test:fs_tests",
    "//src/storage/minfs/test:minfs-integration",
    "//src/storage/minfs/test:minfs_dirty_cache_integration",
    "//src/storage/minfs/test:minfs_micro_benchmark",
    "//src/sys/appmgr:appmgr_for_test",
    "//src/sys/appmgr:bin",
    "//src/sys/appmgr:lib",
    "//src/sys/appmgr:unittest_bin",
    "//src/sys/component_manager/tests/memfs:memfs",
    "//src/sys/component_manager/tests/rights:expose_dir_rights_bin",
    "//src/sys/component_manager/tests/security_policy/capability_allowlist:dir_service_bin",
    "//src/sys/lib/stdout-to-debuglog/cpp:cpp",
    "//src/sys/startup:startup",
    "//src/ui/backlight/bin/backlight:backlight",
    "//src/ui/backlight/drivers/ti-lp8556:ti-lp8556-test",
    "//src/ui/backlight/tests:backlight-test",
    "//src/ui/bin/hardware_display_controller_provider/fake:bin",
    "//src/ui/bin/hardware_display_controller_provider/fake:lib",
    "//src/ui/bin/hardware_display_controller_provider/fake/tests:unittests",
    "//src/ui/examples/tile_view:bin",
    "//src/ui/input/bin/hid:hid",
    "//src/ui/input/drivers/hid:hid-driver",
    "//src/ui/input/drivers/hid:hid-test",
    "//src/ui/input/drivers/hid-buttons:common",
    "//src/ui/input/drivers/hid-buttons:hid-buttons-test",
    "//src/ui/input/drivers/usb-hid:usb-hid-test",
    "//src/ui/input/tests/hid:hid-driver-test",
    "//src/ui/light/drivers/aml-light:aml-light-test",
    "//src/virtualization/bin/guest:bin",
    "//src/virtualization/bin/guest_runner:bin",
    "//zircon/system/ulib/c/test:cdebugdata-test",
    "//zircon/system/ulib/debugdata/test:debugdata",
    "//zircon/system/ulib/fdio-caller/test:fdio-caller",
    "//zircon/system/ulib/fidl-async/test:fidl-async-test",
    "//zircon/system/ulib/log-writer-logger:log-writer-logger",
    "//zircon/system/ulib/mock-boot-arguments:mock-boot-arguments",
    "//zircon/system/ulib/runtests-utils:runtests-utils",
    "//zircon/system/ulib/runtests-utils/test:service-proxy-dir",
    "//zircon/system/ulib/svc:svc",
    "//zircon/system/ulib/sysconfig-client:sysconfig-sync-client",
    "//zircon/system/ulib/syslog:syslog",
    "//zircon/system/ulib/syslog:syslog-compat",
    "//zircon/system/ulib/syslog:syslog-static",
    "//zircon/system/ulib/test-utils:test-utils",
    "//zircon/system/ulib/usb-peripheral-utils:usb-peripheral-utils",
    "//zircon/system/ulib/usb-virtual-bus-launcher:usb-virtual-bus-launcher",
    "//zircon/system/utest/core-display:core-display",
    "//zircon/system/utest/device-enumeration:device-enumeration",
    "//zircon/system/utest/dlfcn:dlfcn",
    "//zircon/system/utest/memfs:memfs",
    "//zircon/system/utest/miscsvc:miscsvc",
    "//zircon/system/utest/service:service-llcpp-test",
    "//zircon/system/utest/svchost:svchost",
    "//zircon/third_party/uapp/dash:dash",
  ]
}

# TODO(fxbug.dev/69585): Delete this config after all user code
# migrates to typed channels.
# This is used by generated C++ library from fidlgen_llcpp, which unfortunately
# cannot have a definite visibility restriction. Please do not use this config.
config(
    "fidl-llcpp-deprecated-raw-channels-reserved-for-llcpp-generated-code-only") {
  cflags_cc = [ "-DFIDL_LLCPP_ALLOW_DEPRECATED_RAW_CHANNELS" ]
}

# TODO(fxbug.dev/85473): Delete this config after all user code
# migrates off |fidl::WireTryDispatch|.
config("fidl-llcpp-deprecated-wire-try-dispatch") {
  cflags_cc = [ "-DFIDL_LLCPP_ALLOW_DEPRECATED_TRY_DISPATCH" ]

  # Please do not add to this list. Refer to fxbug.dev/85473 to see
  # how a target could be migrated to |fidl::WireDispatch|.
  #
  # To regenerate this list, run
  #
  #   scripts/gn/trim_visibility.py --target="//build/cpp:fidl-llcpp-deprecated-wire-try-dispatch"
  #
  # and replace the contents of `visibility` with the script output.
  visibility = [
    "//src/devices/bin/driver_host:common",
    "//src/devices/cpu/bin/cpuctl:cpuctl-test-bin",
    "//src/devices/misc/drivers/compat:lib",
    "//src/devices/rtc/drivers/intel-rtc:intel-rtc-driver",
    "//src/devices/rtc/drivers/intel-rtc:intel-rtc-test-bin",
    "//src/lib/storage/block_client/cpp:block_client_unit_test",
    "//src/lib/storage/vfs/cpp",
    "//src/ui/backlight/drivers/ti-lp8556:ti-lp8556-driver",
    "//src/ui/backlight/drivers/ti-lp8556:ti-lp8556-test",
  ]
}
